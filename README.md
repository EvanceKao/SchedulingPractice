# 排程處理的練習



# 目標:

所有排程的時間安排紀錄，都放在 jobs 這 table 內 (schema 請參考下方說明)。這練習的主要目標是，在 jobs database 只支援被動查詢的限制下，
請設計 worker 完成任務。

任務的需求 (必須全部都滿足):

1. 所有 job 都必須在指定時間範圍內被啟動 (預約時間 + 可接受的延遲範圍)
1. 每個 job 都只能被執行一次, 不能有處理到一半掛掉的狀況
1. 必須支援分散式執行 (多組 worker, 能分散負載, 能互相備援, 支援動態 scaling)

評斷處理機制的品質指標 (按照優先順序):

1. 必須滿足所有上述任務需求
1. Jobs 清單查詢的次數越少越好
1. Jobs 嘗試執行失敗 (搶不到lock) 的次數越少越好
1. Jobs 延遲的時間越短越好 (延遲: 實際啟動時間 - 預約啟動時間)
  * 延遲平均值, 越小越好
  * 延遲標準差, 越小越好
1. 個別 job 狀態查詢的次數 (指定 job id) 越少越好

最終評分 = Sum(指標 x 權重):
1. 執行成本, 越低越好:
```querylist x 100.0 + acquire_failure x 10.0 + queryjob x 1.0```
1. 延遲程度, 越低越好:
```average + stdev```


# 環境準備